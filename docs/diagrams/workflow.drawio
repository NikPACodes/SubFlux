<mxfile host="Electron" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.2.5 Chrome/138.0.7204.251 Electron/37.6.1 Safari/537.36" version="28.2.5">
  <diagram name="Page-1" id="fFDVa9T7LTiJYNI0P9eM">
    <mxGraphModel dx="1622" dy="1191" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="kEauy7DCXx-UyvQxwdDd-1" value="&lt;h2&gt;Workflow основных процессов&lt;/h2&gt;" style="swimlane;whiteSpace=wrap;html=1;fillColor=#dae8fc;gradientColor=#7ea6e0;strokeColor=#6c8ebf;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="41" y="40" width="1119" height="720" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-2" value="&lt;h3&gt;&lt;strong&gt;Добавление новой подписки&lt;/strong&gt;&lt;/h3&gt;" style="swimlane;whiteSpace=wrap;html=1;fillColor=#f5f5f5;gradientColor=#b3b3b3;strokeColor=#666666;" parent="kEauy7DCXx-UyvQxwdDd-1" vertex="1">
          <mxGeometry x="39" y="40" width="550" height="640" as="geometry" />
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="kEauy7DCXx-UyvQxwdDd-2" source="kEauy7DCXx-UyvQxwdDd-3" target="BH73TCdg5YRvaDO4cEw_-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-3" value="" style="swimlane;startSize=0;" parent="kEauy7DCXx-UyvQxwdDd-2" vertex="1">
          <mxGeometry x="30" y="51.63" width="490" height="70" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="kEauy7DCXx-UyvQxwdDd-3" source="kEauy7DCXx-UyvQxwdDd-6" target="kEauy7DCXx-UyvQxwdDd-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-5" value="DRF ViewSet" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="kEauy7DCXx-UyvQxwdDd-4" vertex="1" connectable="0">
          <mxGeometry x="0.0052" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-6" value="Пользователь" style="rounded=0;whiteSpace=wrap;html=1;" parent="kEauy7DCXx-UyvQxwdDd-3" vertex="1">
          <mxGeometry x="35" y="22.5" width="120" height="28" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-7" value="Serializer Validation" style="rounded=0;whiteSpace=wrap;html=1;" parent="kEauy7DCXx-UyvQxwdDd-3" vertex="1">
          <mxGeometry x="335" y="22.5" width="120" height="28" as="geometry" />
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" edge="1" parent="kEauy7DCXx-UyvQxwdDd-2" source="kEauy7DCXx-UyvQxwdDd-16" target="kEauy7DCXx-UyvQxwdDd-19">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="170" y="406" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-16" value="Celery" style="rounded=0;whiteSpace=wrap;html=1;" parent="kEauy7DCXx-UyvQxwdDd-2" vertex="1">
          <mxGeometry x="215" y="391.63" width="120" height="28" as="geometry" />
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" edge="1" parent="kEauy7DCXx-UyvQxwdDd-2" source="kEauy7DCXx-UyvQxwdDd-17" target="kEauy7DCXx-UyvQxwdDd-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-17" value="Создание плановых&lt;div&gt;оповещений&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="kEauy7DCXx-UyvQxwdDd-2" vertex="1">
          <mxGeometry x="330" y="450" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-19" value="Обновление аналитики" style="rounded=0;whiteSpace=wrap;html=1;" parent="kEauy7DCXx-UyvQxwdDd-2" vertex="1">
          <mxGeometry x="110" y="450" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-20" value="Отчеты" style="rounded=0;whiteSpace=wrap;html=1;" parent="kEauy7DCXx-UyvQxwdDd-2" vertex="1">
          <mxGeometry x="110" y="527.88" width="120" height="28" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-21" value="Уведомления" style="rounded=0;whiteSpace=wrap;html=1;" parent="kEauy7DCXx-UyvQxwdDd-2" vertex="1">
          <mxGeometry x="330" y="527.88" width="120" height="28" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-22" value="Ответ ответ пользователю" style="rounded=0;whiteSpace=wrap;html=1;" parent="kEauy7DCXx-UyvQxwdDd-2" vertex="1">
          <mxGeometry x="185" y="595.88" width="190" height="28" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="kEauy7DCXx-UyvQxwdDd-2" source="kEauy7DCXx-UyvQxwdDd-16" target="kEauy7DCXx-UyvQxwdDd-17" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="390" y="406" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="kEauy7DCXx-UyvQxwdDd-2" source="kEauy7DCXx-UyvQxwdDd-19" target="kEauy7DCXx-UyvQxwdDd-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="kEauy7DCXx-UyvQxwdDd-2" source="kEauy7DCXx-UyvQxwdDd-21" target="kEauy7DCXx-UyvQxwdDd-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="kEauy7DCXx-UyvQxwdDd-2" source="BH73TCdg5YRvaDO4cEw_-4" target="BH73TCdg5YRvaDO4cEw_-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-4" value="Расчет даты следующего платежа&lt;div style=&quot;text-wrap-mode: nowrap;&quot;&gt;&lt;span style=&quot;text-wrap-mode: wrap;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;text-wrap-mode: wrap; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;BillingService.&lt;/span&gt;&lt;span style=&quot;text-wrap-mode: wrap; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;calculate_next_payment&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="kEauy7DCXx-UyvQxwdDd-2">
          <mxGeometry x="150" y="171.63" width="250" height="60" as="geometry" />
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="kEauy7DCXx-UyvQxwdDd-2" source="BH73TCdg5YRvaDO4cEw_-6" target="BH73TCdg5YRvaDO4cEw_-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-6" value="Запись в БД:&amp;nbsp;&lt;div&gt;Subscription + BillingSchedule + PriceHistory&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="kEauy7DCXx-UyvQxwdDd-2">
          <mxGeometry x="150" y="271.63" width="250" height="50" as="geometry" />
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="kEauy7DCXx-UyvQxwdDd-2" source="BH73TCdg5YRvaDO4cEw_-8" target="kEauy7DCXx-UyvQxwdDd-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-8" value="on_commit" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="kEauy7DCXx-UyvQxwdDd-2">
          <mxGeometry x="215" y="341.63" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-33" value="&lt;h3&gt;&lt;strong&gt;Ежедневная обработка/ напоминания&lt;/strong&gt;&lt;/h3&gt;" style="swimlane;whiteSpace=wrap;html=1;fillColor=#f5f5f5;gradientColor=#b3b3b3;strokeColor=#666666;" parent="kEauy7DCXx-UyvQxwdDd-1" vertex="1">
          <mxGeometry x="639" y="40" width="441" height="640" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="kEauy7DCXx-UyvQxwdDd-33" source="kEauy7DCXx-UyvQxwdDd-35" target="kEauy7DCXx-UyvQxwdDd-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-35" value="&lt;span style=&quot;text-align: left;&quot;&gt;Celery Beat&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="kEauy7DCXx-UyvQxwdDd-33" vertex="1">
          <mxGeometry x="155" y="40" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yPxYW5y2IiHQ1AJyKWEA-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="kEauy7DCXx-UyvQxwdDd-33" source="kEauy7DCXx-UyvQxwdDd-37" target="kEauy7DCXx-UyvQxwdDd-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-37" value="&lt;div style=&quot;&quot;&gt;Проходим по всем активным подпискам (Subscription) и находим плановые платежей (BullingSchedule)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;" parent="kEauy7DCXx-UyvQxwdDd-33" vertex="1">
          <mxGeometry x="80" y="100" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="kEauy7DCXx-UyvQxwdDd-33" source="kEauy7DCXx-UyvQxwdDd-44" target="BH73TCdg5YRvaDO4cEw_-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-44" value="&lt;div style=&quot;&quot;&gt;Проверяем настройки оповещения по умолчанию и по конкретной подписки, получаем канал оповещения + дни для извещения&lt;/div&gt;&lt;div style=&quot;&quot;&gt;(NotificationSetting)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;" parent="kEauy7DCXx-UyvQxwdDd-33" vertex="1">
          <mxGeometry x="80" y="190" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-46" value="&lt;div style=&quot;&quot;&gt;Лог результата DeliveryAttempt (успешно/ ошибка/ запланировано)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;" parent="kEauy7DCXx-UyvQxwdDd-33" vertex="1">
          <mxGeometry x="20" y="580" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="kEauy7DCXx-UyvQxwdDd-47" value="&lt;div style=&quot;&quot;&gt;Следующая подписка&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;" parent="kEauy7DCXx-UyvQxwdDd-33" vertex="1">
          <mxGeometry x="265.25" y="370" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yPxYW5y2IiHQ1AJyKWEA-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="kEauy7DCXx-UyvQxwdDd-33" source="yPxYW5y2IiHQ1AJyKWEA-2" target="yPxYW5y2IiHQ1AJyKWEA-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="yPxYW5y2IiHQ1AJyKWEA-2" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Проверяем наступление&amp;nbsp; day_to_payment (billing_service)&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;" parent="kEauy7DCXx-UyvQxwdDd-33" vertex="1">
          <mxGeometry x="20" y="430" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="yPxYW5y2IiHQ1AJyKWEA-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="kEauy7DCXx-UyvQxwdDd-33" source="yPxYW5y2IiHQ1AJyKWEA-10" target="kEauy7DCXx-UyvQxwdDd-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="yPxYW5y2IiHQ1AJyKWEA-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="kEauy7DCXx-UyvQxwdDd-33" source="yPxYW5y2IiHQ1AJyKWEA-10" target="kEauy7DCXx-UyvQxwdDd-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="yPxYW5y2IiHQ1AJyKWEA-10" value="&lt;div style=&quot;&quot;&gt;Отправка уведомления&lt;/div&gt;&lt;div style=&quot;&quot;&gt;Email/Telegram/Push&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;" parent="kEauy7DCXx-UyvQxwdDd-33" vertex="1">
          <mxGeometry x="20" y="510" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="yPxYW5y2IiHQ1AJyKWEA-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="kEauy7DCXx-UyvQxwdDd-33" source="yPxYW5y2IiHQ1AJyKWEA-11" target="yPxYW5y2IiHQ1AJyKWEA-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="yPxYW5y2IiHQ1AJyKWEA-11" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Создание NotificationEvent&amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;" parent="kEauy7DCXx-UyvQxwdDd-33" vertex="1">
          <mxGeometry x="20" y="370" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="kEauy7DCXx-UyvQxwdDd-33" source="BH73TCdg5YRvaDO4cEw_-19" target="yPxYW5y2IiHQ1AJyKWEA-11">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="105" y="325" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-22" value="Да" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="BH73TCdg5YRvaDO4cEw_-21">
          <mxGeometry x="-0.3362" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="kEauy7DCXx-UyvQxwdDd-33" source="BH73TCdg5YRvaDO4cEw_-19" target="kEauy7DCXx-UyvQxwdDd-47">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="330" y="325" />
              <mxPoint x="330" y="350" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-24" value="Нет" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="BH73TCdg5YRvaDO4cEw_-23">
          <mxGeometry x="-0.4457" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="BH73TCdg5YRvaDO4cEw_-19" value="Настройка&lt;div&gt;оповещений&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="kEauy7DCXx-UyvQxwdDd-33">
          <mxGeometry x="174.75" y="280" width="90.5" height="90" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
